setwd("C:/Users/chhaj/OneDrive/Desktop/AnalyticsProjects/Multichannel Retail Store Analysis")
LineItems = read.csv("Lines.csv")
LineItems = read.csv("DMEFExtractLines.csv")
str(LineItems)
#install.packages("dplyr")
library(dplyr)
#install.packages("lubridate")
library(lubridate)
LineItems$OrderDate = as.Date(as.character(LineItems$OrderDate), format = "%Y%m%d")
LineItems$MonthDiff = interval(LineItems$OrderDate, "2007-12-31") %/% months(1)
LineItems$IsGift<-ifelse(LineItems$Gift=="Y",1,0)
Recency = aggregate(LineItems$MonthDiff, list(LineItems$Cust_ID), FUN = min)
Frequency = aggregate(LineItems$Cust_ID, list(LineItems$Cust_ID), FUN = length)
Monetary = aggregate(LineItems$LineDollars, list(LineItems$Cust_ID), FUN = sum)
Gifting = aggregate(LineItems$IsGift, list(LineItems$Cust_ID), FUN = sum)
Merged_Data = merge(Recency, Frequency, by = "Group.1", all = TRUE)
RFM = merge(Merged_Data, Monetary, by = "Group.1", all = TRUE)
colnames(RFM) = c('Cust_ID', 'Recency', 'Frequency', 'Monetary', 'Gifting')
RFM$Recency_Score = cut(RFM$Recency, 9 ,labels=F)
Merged_Data = merge(Recency, Frequency, by = "Group.1", all = TRUE)
RFM = merge(Merged_Data, Monetary, by = "Group.1", all = TRUE)
colnames(RFM) = c('Cust_ID', 'Recency', 'Frequency', 'Monetary', 'Gifting')
str(rfm)
str(RFM)
RFM$Recency_Score = cut(RFM$Recency, 9 ,labels=F)
RFM$RFM_Score = RFM$Recency_Score*100 + RFM$Frequency_Score*10 + RFM$Monetary_Score
LineItems = read.csv("DMEFExtractLinesV01.csv")
LineItems = read.csv("DMEFExtractLines.csv")
str(LineItems)
install.packages("dplyr")
library(dplyr)
install.packages("lubridate")
library(lubridate)
LineItems$OrderDate = as.Date(as.character(LineItems$OrderDate), format = "%Y%m%d")
LineItems$MonthDiff = interval(LineItems$OrderDate, "2007-12-31") %/% months(1)
Recency = aggregate(LineItems$MonthDiff, list(LineItems$Cust_ID), FUN = min)
Frequency = aggregate(LineItems$Cust_ID, list(LineItems$Cust_ID), FUN = length)
Monetary = aggregate(LineItems$LineDollars, list(LineItems$Cust_ID), FUN = sum)
Merged_Data = merge(Recency, Frequency, by = "Group.1", all = TRUE)
RFM = merge(Merged_Data, Monetary, by = "Group.1", all = TRUE)
colnames(RFM) = c('Cust_ID', 'Recency', 'Frequency', 'Monetary')
RFM$Recency_Score = cut(RFM$Recency, 9 ,labels=F)
RFM$Frequency_Score = cut(RFM$Frequency, 9 ,labels=F)
RFM$Monetary_Score = cut(RFM$Monetary, 9 ,labels=F)
RFM$RFM_Score = RFM$Recency_Score*100 + RFM$Frequency_Score*10 + RFM$Monetary_Score
head(RFM, 20)
install.packages("dplyr")
install.packages("lubridate")
cat("\014")
LineItems = read.csv("DMEFExtractLines.csv")
str(LineItems)
library(dplyr)
library(lubridate)
LineItems$OrderDate = as.Date(as.character(LineItems$OrderDate), format = "%Y%m%d")
LineItems$MonthDiff = interval(LineItems$OrderDate, "2007-12-31") %/% months(1)
Recency = aggregate(LineItems$MonthDiff, list(LineItems$Cust_ID), FUN = min)
Frequency = aggregate(LineItems$Cust_ID, list(LineItems$Cust_ID), FUN = length)
Monetary = aggregate(LineItems$LineDollars, list(LineItems$Cust_ID), FUN = sum)
Merged_Data = merge(Recency, Frequency, by = "Group.1", all = TRUE)
RFM = merge(Merged_Data, Monetary, by = "Group.1", all = TRUE)
colnames(RFM) = c('Cust_ID', 'Recency', 'Frequency', 'Monetary')
RFM$Recency_Score = cut(RFM$Recency, 9 ,labels=F)
RFM$Frequency_Score = cut(RFM$Frequency, 9 ,labels=F)
RFM$Monetary_Score = cut(RFM$Monetary, 9 ,labels=F)
RFM$RFM_Score = RFM$Recency_Score*100 + RFM$Frequency_Score*10 + RFM$Monetary_Score
head(RFM, 20)
